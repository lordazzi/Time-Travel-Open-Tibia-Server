<?php# AUTHOR: RICARDO AZZI ## CREATED: 05/10/12 #class Spells {	private $xml;	private $array;	private $json;		public function __construct() {		$this->xml = new Xml($GLOBALS["SERVER_PATH"]."/data/spells/spells.xml");		$this->array = $this->xml->getArray();		$this->json = $this->xml->getJson();	}		public function doSearch($array) {				$types = array(			"newarray" => "newarray"		);		unset($types["newarray"]);				//FILTRANDO O TIPO		if ($array["type"]["instant"] == TRUE OR $array["type"]["all"] == TRUE) {			$types = $this->array["instant"];		}				if ($array["type"]["conjure"] == TRUE OR $array["type"]["all"] == TRUE) {			$types = array_merge($types, $this->array["conjure"]);		}				foreach ($types as &$type) {			$type["@attributes"] = select_array($type["@attributes"], array(				"name", "words", "lvl", "prem", "mana", "display"			));						if ($type["@attributes"]["display"] == "none") {				$type = NULL;				continue;			}						//FILTRANDO POR VOCAЧеES			if ($type["vocation"]) {				if (COUNT($type["vocation"]) != 0) {					foreach ($type["vocation"] as &$voc) {						$voc = $voc["@attributes"]["name"];					}										if (!array_in_array($array["vocacoes"], $type["vocation"])) {						$type = NULL;					}				}			}						//FILTRANDO PELO GRUPO			if ($array["group"]["all"] == FALSE) {				if ($type["@attributes"]["group"] == "attack" AND $array["group"]["attack"] == FALSE) {					$type = NULL;				}								if ($type["@attributes"]["group"] == "healing" AND $array["group"]["healing"] == FALSE) {					$type = NULL;				}								if ($type["@attributes"]["group"] == "support" AND $array["group"]["support"] == FALSE) {					$type = NULL;				}			}						//FILTRANDO VIP			if ($array["vip"]["all"] == FALSE) {				if ($type["@attributes"]["prem"] == 1 AND $array["vip"]["yes"] == FALSE) {					$type = NULL;				}								if ($type["@attributes"]["prem"] == 0 AND $array["vip"]["no"] == FALSE) {					$type = NULL;				}			}		}				$retorno = array();		foreach ($types as $type) {			if (!is_null($type)) {				$pedaco = $type["@attributes"];				$pedaco["vocation"] = $type["vocation"];				$retorno[] = $pedaco;			}		}				return $retorno;	}		public function getJson() {		return $this->json;	}		public function getArray() {		return $this->array;	}}?>